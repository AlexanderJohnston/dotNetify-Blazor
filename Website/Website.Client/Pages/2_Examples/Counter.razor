@page "/counter"

<h1>Counter</h1>

<VMContext @ref="vm" VM="Counter" OnStateChange="(ICounterState state) => HandleStateChange(state)">
    <p>Current count: @state?.CurrentCount</p>

    <button class="btn btn-primary" @onclick="IncrementCountAsync">Click me</button>
</VMContext>

@code {
   ICounterState state;
   VMContext<ICounterState> vm;

   public interface ICounterState
   {
       int CurrentCount { get; set; }
   }

   void HandleStateChange(ICounterState newState )
   {
       state = newState;
       StateHasChanged();
   }

   async void IncrementCountAsync()
   {
       await vm.DispatchAsync("IncrementCount");
   }
}