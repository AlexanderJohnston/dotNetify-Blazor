@page "/form"

<VMContext VM="CustomerForm" TState="object" OnElementEvent="HandleElementEvent">
    <d-panel>
        <d-data-grid id="Contacts"></d-data-grid>
        @if (editMode)
        {
            <d-form id="_Form">
                <FormBody EditMode="true" />
            </d-form>
        }
        else
        {
            <d-form id="_Form" plaintext="true">
                <FormBody EditMode="false" />
            </d-form>
            @if (showDialog)
            {
                <NewFormDialog OnClosed="@ToggleDialog"></NewFormDialog>
            }
        }
    </d-panel>
</VMContext>

@code {
   private bool editMode;
   private bool showDialog = false;

   private void HandleElementEvent(ElementEvent elementEvent)
   {
       if (elementEvent.TargetId == "_Edit" || elementEvent.TargetId == "_Cancel" || elementEvent.TargetId == "Submit")
           editMode = !editMode;
       else if (elementEvent.TargetId == "_New")
           ToggleDialog();

       StateHasChanged();
   } 

   private void ToggleDialog()
   {
       showDialog = !showDialog;
       StateHasChanged();
   }
}